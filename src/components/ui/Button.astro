---
// filepath: src/components/ui/Button.astro
export interface Props {
  variant?: "fixed" | "flexible";
  type?: "button" | "submit" | "reset";
  disabled?: boolean;
  loading?: boolean;
  href?: string;
  class?: string;
}

const {
  variant = "fixed",
  type = "button",
  disabled = false,
  loading = false,
  href,
  class: className = "",
  ...rest
} = Astro.props;

const Tag = href ? "a" : "button";

// Classes Tailwind dynamiques
const baseClasses = "border-none cursor-pointer transition-colors duration-300 text-white font-medium no-underline font-secondary transform-none shadow-none text-sm";

const variantClasses = {
  fixed: "flex min-w-[100px] h-10 px-4 justify-center items-center rounded-[14px] w-auto",
  flexible: "flex h-10 px-3 items-center flex-shrink-0 self-stretch rounded-[14px]"
};

const colorClasses = "bg-[#003366] hover:bg-[#830000]";
const disabledClasses = disabled ? "opacity-50 cursor-not-allowed hover:bg-[#003366]" : "";

const finalClasses = `${baseClasses} ${variantClasses[variant]} ${colorClasses} ${disabledClasses} ${className}`;
---

<Tag
  class={finalClasses}
  type={href ? undefined : type}
  disabled={disabled || loading}
  href={href}
  {...rest}
>
  {loading && (
    <svg class="animate-spin h-4 w-4 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
    </svg>
  )}
  <slot />
</Tag>
