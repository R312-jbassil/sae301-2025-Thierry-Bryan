/// <reference path="../pb_data/types.d.ts" />
migrate((app) => {
  const collection = app.findCollectionByNameOrId("_pb_users_auth_")

  // update collection data
  unmarshal({
    "verificationTemplate": {
      "body": "<body style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f9fafb;\">\n    \n    <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);\">\n        <tr>\n            <td style=\"padding: 40px;\">\n                \n                <!-- Header -->\n                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n                    <tr>\n                        <td style=\"text-align: center; margin-bottom: 30px;\">\n                            <h1 style=\"font-size: 32px; font-weight: bold; color: #003366; margin: 0 0 8px 0;\">TaVue</h1>\n                            <p style=\"color: #6b7280; font-size: 14px; margin: 0 0 20px 0;\">Vos lunettes sur mesure, fabriqu√©es en France</p>\n                            <div style=\"height: 3px; background: linear-gradient(90deg, #003366 0%, #ffffff 50%, #830000 100%); margin: 20px 0; border-radius: 2px;\"></div>\n                        </td>\n                    </tr>\n                </table>\n                \n                <!-- Content -->\n                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n                    <tr>\n                        <td>\n                            <h2 style=\"color: #003366; margin: 0 0 16px 0; font-size: 24px;\">V√©rifiez votre adresse email</h2>\n                            \n                            <p style=\"margin: 0 0 16px 0;\">Bonjour,</p>\n                            \n                            <p style=\"margin: 0 0 20px 0;\">Merci de vous √™tre inscrit sur <strong>TaVue</strong> ! Pour finaliser la cr√©ation de votre compte et commencer √† cr√©er vos lunettes personnalis√©es, veuillez v√©rifier votre adresse email en cliquant sur le bouton ci-dessous :</p>\n                            \n                            <!-- Button -->\n                            <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n                                <tr>\n                                    <td style=\"text-align: center; padding: 20px 0;\">\n                                        <a href=\"{APP_URL}/auth/confirm-verification/{TOKEN}\" style=\"display: inline-block; background: #003366; color: white; padding: 16px 32px; text-decoration: none; border-radius: 8px; font-weight: 500; font-size: 16px;\">\n                                            ‚úÖ V√©rifier mon email\n                                        </a>\n                                    </td>\n                                </tr>\n                            </table>\n                            \n                            <p style=\"margin: 20px 0 16px 0;\">Une fois votre email v√©rifi√©, vous pourrez :</p>\n                            <ul style=\"margin: 0 0 20px 0; padding-left: 20px;\">\n                                <li style=\"margin-bottom: 8px;\">üé® Personnaliser vos lunettes avec notre configurateur</li>\n                                <li style=\"margin-bottom: 8px;\">üíæ Sauvegarder vos cr√©ations</li>\n                                <li style=\"margin-bottom: 8px;\">üõí Passer commande facilement</li>\n                                <li style=\"margin-bottom: 8px;\">üì¶ Suivre vos commandes</li>\n                            </ul>\n                            \n                            <div style=\"margin: 24px 0; padding: 16px; background: #f3f4f6; border-radius: 8px; border-left: 4px solid #003366;\">\n                                <p style=\"margin: 0 0 8px 0; font-weight: bold;\">Lien alternatif :</p>\n                                <p style=\"margin: 0; font-size: 14px;\">Si le bouton ne fonctionne pas, copiez-collez ce lien dans votre navigateur :</p>\n                                <p style=\"margin: 8px 0 0 0; word-break: break-all; font-size: 14px;\">\n                                    <a href=\"{APP_URL}/auth/confirm-verification/{TOKEN}\" style=\"color: #003366;\">\n                                        {APP_URL}/auth/confirm-verification/{TOKEN}\n                                    </a>\n                                </p>\n                            </div>\n                            \n                            <div style=\"margin: 24px 0; padding: 12px; background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 4px;\">\n                                <p style=\"margin: 0; font-size: 14px;\">\n                                    ‚ö†Ô∏è <strong>Important :</strong> Ce lien expire dans <strong>24 heures</strong>. Si vous ne l'avez pas demand√©, ignorez cet email.\n                                </p>\n                            </div>\n                        </td>\n                    </tr>\n                </table>\n                \n                <!-- Footer -->\n                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n                    <tr>\n                        <td style=\"margin-top: 40px; padding-top: 20px; border-top: 1px solid #e5e7eb; font-size: 12px; color: #6b7280; text-align: center;\">\n                            <p style=\"margin: 0 0 8px 0;\"><strong>TaVue</strong> - L'excellence fran√ßaise au service de votre vue</p>\n                            <p style=\"margin: 0;\">\n                                Cet email a √©t√© envoy√© √† <strong>{EMAIL}</strong><br>\n                                Si vous avez des questions, contactez-nous : \n                                <a href=\"mailto:support@tavue.fr\" style=\"color: #003366;\">support@tavue.fr</a>\n                            </p>\n                        </td>\n                    </tr>\n                </table>\n                \n            </td>\n        </tr>\n    </table>\n    \n</body>"
    }
  }, collection)

  return app.save(collection)
}, (app) => {
  const collection = app.findCollectionByNameOrId("_pb_users_auth_")

  // update collection data
  unmarshal({
    "verificationTemplate": {
      "body": "<p>Hello,</p>\n<p>Thank you for joining us at {APP_NAME}.</p>\n<p>Click on the button below to verify your email address.</p>\n<p>\n  <a class=\"btn\" href=\"{APP_URL}/_/#/auth/confirm-verification/{TOKEN}\" target=\"_blank\" rel=\"noopener\">Verify</a>\n</p>\n<p>\n  Thanks,<br/>\n  {APP_NAME} team\n</p>"
    }
  }, collection)

  return app.save(collection)
})
